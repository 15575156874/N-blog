{
  "name": "koa-scheme",
  "version": "0.3.5",
  "description": "koa-scheme is a parameter validation middleware for koa.",
  "main": "index.js",
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "https://github.com/MangroveTech/koa-scheme"
  },
  "keywords": [
    "koa",
    "scheme",
    "parameter",
    "validation",
    "check"
  ],
  "dependencies": {
    "debug": "^1.0.4",
    "flat": "^1.2.1",
    "path-to-regexp": "~0.2.3"
  },
  "readme": "## koa-scheme\n\nkoa-scheme is a parameter validation middleware for koa. It's very easy for using, checkout ~\n\n### Install\n\n    npm i koa-scheme --save\n    \n### Usage\n\n**scheme.json**\n\n```\n{\n  \"/user/:user\": {\n    \"request\": {\n      \"method\": \"(POST|PATCH)\",\n      \"header\": {\n        \"x-gg-user\": \"[a-zA-Z]+\",\n        \"x-mm-user\": \"[a-zA-Z]+\"\n      },\n      \"query\": {\n        \"vip\": true\n      },\n      \"body\": {\n        \"name\": \"[a-zA-Z]+\",\n        \"age\": \"[0-9]{1,2}\",\n        \"family\": {\n          \"sister\": {\n            \"name\": \".+\",\n            \"age\": \"[0-9]{1,2}\"\n          },\n          \"mother\": {...},\n          \"father\": {...}\n        }\n      },\n      ...\n    },\n    \"response\": {\n      \"body\": {\n        \"name\": \"[a-zA-Z]+\",\n        \"age\": \"[0-9]{1,2}\",\n        \"family\": {\n          \"sister\": {\n            \"name\": \".+\",\n            \"age\": \"[0-9]{1,2}\"\n          }\n        }\n      }\n    }\n  },\n  \"/file/:user\": {\n    \"request\": {...},\n    \"response\": {...}\n  },\n  ...\n}\n```\n\nor a better way:\n\n**scheme.js**\n\n```\nmodule.exports = {\n  \"/\": {\n    \"request\": {\n      \"method\": \"POST\",\n      \"body\": {\n        \"nameArr\": testRequestNameArr\n      }\n    }\n  }\n}\n\nfunction testRequestNameArr(arr) {\n  if (arr.length === 3 && arr[1] === 'nswbmw') {\n    return true;\n  } else {\n    return false;\n  }\n}\n```\n\nor:\n\n```\nmodule.exports = {\n  \"GET /user/:name\": {\n    \"request\": {\n      ...\n    },\n    \"response\": {\n      \"body\": {\n        \"name\": \"[_0-9a-zA-Z]{6, 20}\"\n      }\n    }\n  },\n  \"POST /user\": {\n    \"request\": {\n      \"body\": {\n        \"name\": \"[_0-9a-zA-Z]{6, 20}\"\n      }\n    }\n  }\n}\n```\n\n**app.js**\n\n```\nvar koa = require('koa');\nvar bodyParser = require('koa-bodyparser');\nvar scheme = require('koa-scheme');\nvar conf = require('./scheme');\n//var route = require('./route/');\n\nvar app = koa();\napp.use(bodyParser());\napp.use(function* (next) {\n  try {\n    yield next;\n  } catch (e) {\n    console.log(e.message)\n  }\n});\napp.use(scheme(conf));\n\napp.use(function* () {\n  this.body = {\n    name: \"nswbmw\",\n    age: 23,\n    family: {\n      sister: {\n        age: 28\n      }\n    }\n  }\n});\n\n//route(app);\napp.listen(3000, function() {\n  console.log(\"listening on 3000\")\n});\n```\n**NB**: when use koa-bodyparser before koa-scheme, you could configure 'body' field in 'request'.\n\n### Screenshot\n\n```\ncurl -i -X POST \\\n    -H \"Content-Type: application/json\" \\\n    -H 'X-GG-User: gg' \\\n    -H 'X-MM-User: mm' \\\n    -d '{\"name\": \"nswbmw\", \"age\": 23, \"family\": {\"sister\": {\"name\": \"sister\", \"age\": 28}}}' \\\n    'http://localhost:3000/user/nswbmw?vip=true'\n    \ncurl -i -X PATCH \\\n    -H \"Content-Type: application/json\" \\\n    -H 'X-GG-User: gg' \\\n    -H 'X-MM-User: mm' \\\n    -d '{\"name\": \"nswbmw\", \"age\": 23, \"family\": {\"sister\": {\"name\": \"sister\", \"age\": 28}}}' \\\n    'http://localhost:3000/user/nswbmw?vip=true'\n\ncurl -i -X POST \\\n    -H \"Content-Type: application/json\" \\\n    -H 'X-GG-User: gg' \\\n    -H 'X-MM-User: mm' \\\n    -d '{\"name\": \"nswbmw\", \"age\": 23, \"family\": {\"sister\": {\"name\": \"sister\", \"age\": 28}}}' \\\n    'http://localhost:3000/user/nswbmw?vip=false'\n\ncurl -i -X POST \\\n    -H \"Content-Type: application/json\" \\\n    -H 'X-GG-User: gg' \\\n    -H 'X-MM-User: mm' \\\n    -d '{\"name\": \"nswbmw\", \"age\": 23, \"family\": {\"sister\": {\"name\": \"sister\", \"age\": 28}}}' \\\n    'http://localhost:3000/user/nswbmw'\n\ncurl -i -X PATCH \\\n    -H \"Content-Type: application/json\" \\\n    -H 'X-GG-User: gg' \\\n    -H 'X-MM-User: mm' \\\n    -d '{\"name\": 23, \"age\": \"nswbmw\", \"family\": {\"sister\": {\"name\": \"sister\", \"age\": 28}}}' \\\n    'http://localhost:3000/user/nswbmw?vip=true'\n```\n\n![](https://github.com/MangroveTech/koa-scheme/blob/master/example.png?raw=true)\n\n### License\n\nMIT\n\n\n\n\n",
  "readmeFilename": "readme.md",
  "bugs": {
    "url": "https://github.com/MangroveTech/koa-scheme/issues"
  },
  "homepage": "https://github.com/MangroveTech/koa-scheme",
  "_id": "koa-scheme@0.3.5",
  "_shasum": "b699bee33e955d69558e833e544ae946bf1f0544",
  "_from": "koa-scheme@0.3.5",
  "_resolved": "https://registry.npmjs.org/koa-scheme/-/koa-scheme-0.3.5.tgz"
}
